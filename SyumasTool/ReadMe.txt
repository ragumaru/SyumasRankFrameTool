週刊アイドルマスターランキング用　ランキング情報画像生成ツール

■概要
　このツールは、週刊アイドルマスターランキングに使用するランキング情報の
画像を自動で生成するものです。（Windows用です）

■ファイル構成
+ _fonts フォルダ		あずきフォントが格納されています。
+ _image フォルダ		ランキング情報に使用するフレームが格納してあるフォルダです。
+ runtimes				動作に必要なライブラリです。
- ～～～.dll			動作に必要なライブラリです。
- ranklist.xls          ランキング情報ファイルのサンプルです。
- SyumasTool.exe        本ツールの実行ファイルです。

■動作に必要なアプリケーション
・.NET7.0 デスクトップランタイム（WindowsUpdateを行っていれば自動的にインストールされているはずです）

☆Excelファイルはxls、xlsx形式に対応しています。
  Excelが無くても動作します。
  ※前バージョンではExcelでインストールされるフォントを使用していましたが、現バージョンでは使用していません。

■ranklist.xls ファイルの各シートの説明
☆項目が緑色のものは、入力必須項目です。
　黄色のものは、省略可能項目です。

- ranking
　⇒ランキング情報です。各動画の情報を入力してください。
　　・順位差識別は、囲み枠の説明に従って入力してください。
　　・動画開始秒数、動画紹介秒数、動画ファイル名、フレームYオフセット、Pts表示色、登録表示色、再生表示色は現在は使用していません。

- cutin
　⇒各順位紹介の前に表示されるカットイン用の画像に使用する情報です。

- jogai
　⇒除外リストです。

- summary
　⇒集計概要情報です。

- stage　※使用していません
  ⇒アイドルの出演回数でしたが、人数の増加やカウントが困難になったため使用しなくなりました。

- play_rank
　⇒マイリスト登録数、再生数の順位です。リストの数はある程度は可変です。

- out_of_range_list
　⇒紹介圏外順位表です。


■雑記
説明が簡素ですみません。改善点、意見等ありましたらメールにてお願いいたします。

■連絡先
msc.karatあっとgmail.com

■変更履歴
2023/05/23  Ver 4.0
・カットインの出力に対応。

2023/04/21  Ver 4.0 Beta4
・集計概要の出力に対応。
・ランキングフレームのファイル名の数値を3桁0埋めで出力するようにした。

2023/04/16  Ver 4.0 Beta3
・除外リストの出力に対応。

2023/03/27  Ver 4.0 Beta2
・ランキングフレームの動画タイトルの太文字指定ミスの修正。
・ランキングフレーム逆向き生成に対応。
・実行中に進捗（プログレスバー）を表示するようにした。

2023/03/22  Ver 4.0 Beta1
※あずきフォントが読み込めなくなった件を調査しようとしたが、HDDクラッシュでソースが消失しているため
　どうにもならないので、イチからプログラムを組みなおしています。
　実に12年ぶりのバージョンアップｗ
　描画方法を変えた(WPF動的生成だった？うろ覚え→SkiaSharp)ため、全体的に配置やエフェクトを変えています

・画像出力先フォルダを指定するようにし、その中に自動的に現日時のframeフォルダを自動生成するようにした。
・ランキングフレームのワイド画像生成に対応（逆向きには未対応、他画像も未対応）
　順位の位置、順位差の縁取り、動画タイトルが長い場合に横方向に縮めるなど前バージョンより改善

2011/07/20  Ver 3.3
・Settings.xml をツールが置いてあるディレクトリから読み込むように明示的に指定。

2011/07/18  Ver 3.2
・Settings.xml でランキングフレームを指定するように変更。
・ランキングフレームでプロデューサー名が長い場合に、フォントサイズを小さくする処理を追加。

2011/04/16  Ver 3.1
・ランキングフレームの順位差が"新"の場合、文字を出力しないように変更。

2011/03/09  Ver 3.0 正式版
・紹介圏外リスト、出演回数リストでフォントが「あずきフォント」だったのを
　「あずきフォントP」に変更。
・ピックアップを廃止。

2011/03/08  Ver 3.0 Beta7
・ランキングファイルの最終行検知方法改善。
・集計概要で先週比の青字赤字の色判定が逆になっていた不具合を修正。
・出演回数でソロが0のときでも出力していた不具合を修正。

2011/03/05  Ver 3.0 Beta6
・集計概要の生成対応。
・カットインの調整。
・紹介圏外リストの調整。
・ランキングフレームの数値がカンマ書式になっていなかったバグを修正。
・除外リストの数値をカンマ書式にした。

2011/02/20  Ver 3.0 Beta5
・除外リスト、紹介圏外リスト生成の対応。
・ランキングフレームに順位差を追加。
・出演回数画像の文字調整。

2011/02/13  Ver 3.0 Beta4
・カットイン、出演回数画像生成の対応。

2011/02/06  Ver 3.0 Beta3
・ランキングフレームでタイトル文字が長い場合に、フォントサイズを小さくする処理を追加。

2011/02/01  Ver 3.0 Beta2
・バグ修正。
・文字位置の調整など。
・Keepフレーム追加。

2011/01/31  Ver 3.0 Beta1
・ベータ版制限事項としてランキングフレーム出力のみ対応。（ワイド版未対応）
・フレーム画像を刷新した。（くたーさん提供）
・GDI+で描画していたものを、WPFで画像を出力するようにした。
  その影響で.NET Frameworkのバージョンを3.5とした。
・ランキングファイルの読み込みはNPOIを使用するようにした。
・その他いろいろ（プログラムを全面刷新）

2010/05/06  Ver 2.1
・ODBC経由でのランキングファイル読み込み時に不具合があったのを修正。
・rankingシートのフレームYオフセットに正の数を指定すると、
　rankingFrameの順位が下付きになる機能を追加した。

2010/05/05  Ver 2.0
・Excelを使用せずに、ODBC経由で読み込めるようにした。
　⇒Settings.iniで設定します。
　　--------------------
　　 [ExcelFileReader]
　　 UseODBC=1
　　--------------------
　　上記設定でランキングファイルはODBC経由での読み込みになります。
　　（Excelが無くても読み込みます）
　　設定値を 0 にすると、従来通りにExcelを裏で起動して
　　ランキングファイルの内容を読み取ります。
・動画IDが1000万に達し桁が増えたことへの対応。
　⇒rankingFrameで、作者名を左にずらした。
　⇒jogaiListで、作者名と動画IDの横位置を調整。
・jogaiListで自動改ページが行われるようにした。また、行間隔を広げた。

2008/11/20  Ver 1.8
・紹介圏外順位表で「除外」列に表示する文字によって色を指定できるようにした。
　（Settings.iniで指定）

2008/11/05  Ver 1.7
・rankingFrameとrankingTextで同順位がある場合、連番を付加するようにした。

2008/10/19  Ver 1.6
・rankingFrameとrankingTextのファイル名に付加する連番を順位で0埋めの3桁固定とした。
　また、長期作品の場合は連番の後に"L(連番)"を付加するようにした。

2008/09/15  Ver 1.5
・タイトルバーに表示されるバージョンの表記を変更。
・長期作品（殿堂入り）に対応。
・Settings.iniの長期作品対応及び除外リスト、出演回数リスト、集計概要、
　登録数及び再生数の順位、圏外リストのタイトルフォントと項目の縦位置の設定追加。
・集計概要を出演回数リストからを外し、登録再生数リストに移動。
・上記に伴う、生成される画像ファイル名の変更。
・生成先スクリプトファイルを省略可能とした。

2008/07/05  Ver 1.1
・「登録数及び再生数の順位」の再生順位が、登録順位と同じ文字色になっているのを修正。

2008/02/22  Ver 1.0
・色々

2008/02/20  Ver 0.7 Beta
・週マス掲示板で初公開

2008/01/13頃～2008/02/19  Ver 0.1 Alpha ～ Ver 0.6 Beta
・開発途中版

以上
